drop database SIO_Proj1;
create database SIO_Proj1;

use SIO_Proj1;

    CREATE TABLE User
    (
        Username varchar(50) not null primary key,
        Password binary(64) not null,
        Name varchar(100) not null,
        PhoneNumber varchar(15),
        Email varchar(100), 
        Age int not null,
        Role varchar(10) not null
    );

    CREATE TABLE Product
    (
        Name varchar(50) not null primary key,
        Description varchar(300),
        Price int not null,
        Qty int not null
    );

    CREATE TABLE Image
    (  
        ID int auto_increment not null primary key,
        Link varchar(400) not null
    );

    CREATE TABLE Product_Has_Image
    (  
        PName varchar(50) not null,
        ImageID int not null ,
        FOREIGN KEY (Pname) REFERENCES Product(Name),
        primary key(Pname,ImageID) 
    );

    CREATE TABLE Review
    (  
        ID int not null primary key auto_increment,
        PName varchar(50) not null ,
        ReviewBody varchar(400) not null,
        FOREIGN KEY (Pname) REFERENCES Product(Name)

    );

    CREATE TABLE Category
    (  
        Name varchar(50) not null primary key,
        Description varchar(300)
    );

    CREATE TABLE Category_Has_Product
    (  
        CName varchar(50) not null ,
        PName varchar(50) not null ,
        FOREIGN KEY (Cname) REFERENCES Category(Name),
        FOREIGN KEY (Pname) REFERENCES Product(Name),
        primary key(Cname,Pname) 
    );


    CREATE TABLE `Order`
    (  
        ID int not null primary key auto_increment,
        Client varchar(50) not null,
        Date datetime not null,
        ConcDate datetime,
        Description varchar(300),
        FOREIGN KEY (Client) REFERENCES User(Username)

    );


    CREATE TABLE Order_Has_Product
    (  
        `Order` int not null ,
        PName varchar(50) not null ,
        Qty int not null,
        FOREIGN KEY (`Order`) REFERENCES `Order`(ID),
        FOREIGN KEY (Pname) REFERENCES Product(Name),
        primary key(`Order`,Pname) 
    );

    CREATE TABLE Cart
    (  
        ID int not null primary key auto_increment,
        Client varchar(50) not null,
        PName varchar(50) not null ,
        FOREIGN KEY (Client) REFERENCES User(Username)
    );

    CREATE TABLE Wishlist
    (  
        ID int not null primary key auto_increment,
        Client varchar(50) not null,
        PName varchar(50) not null ,
        FOREIGN KEY (Client) REFERENCES User(Username)

    );